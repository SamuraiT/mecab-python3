dist: trusty
language: python

addons:
  apt:
    packages:
     - libmecab-dev
     - mecab
     - mecab-ipadic-utf8
     - swig

install:
 - pip install coverage coveralls
 - python setup.py install

script:
 - coverage run test.py

after_success:
 - coveralls

matrix:
  include:
  - python: '2.7'
  - python: '3.5'
  - python: '3.6'
  - os: osx
    language: generic
    env: DEPLOY="true"
    install: true
    script: "./ci/build-macos.sh"
    after_succes: true
  - service: docker
    sudo: required
    env: DEPLOY="true"
    install: true
    script: "docker run --rm -v `pwd`:/io quay.io/pypa/manylinux1_x86_64 /io/ci/build-manylinux.sh"
    after_succes: true
deploy:
  provider: releases
  file_glob: true
  file: dist/*
  skip_cleanup: true
  on:
    tags: true
    repo: SamuraiT/mecab-python3
    condition: "$DEPLOY = true"
  # Replace appropreate api_key
  #api_key:
  #  secure: REPLACE-ME